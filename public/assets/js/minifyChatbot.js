var ip="",data="",count=0;function send_guest_msg(s,e){$.ajax({type:"post",url:"/send/guest/message",data:{ip:s,msg:e},success:function(s){}})}function get_questions(){$.ajax({type:"get",url:"/get/chatbot/questions",async:!1,success:function(s){data=s}})}function reply(s){0==s?(count=1,$(".Messages_list").append('<div class="msg"><span class="avtr"><figure style="background-image: url(https://demo.umbrellamd-video.com/assets/images/logo.png)"></figure></span><span class="responsText">Now you are connected with our agent send a msg</span></div>')):$.each(JSON.parse(data),function(e,a){a.id==s&&$(".Messages_list").append('<div class="msg"><span class="avtr"><figure style="background-image: url(https://demo.umbrellamd-video.com/assets/images/logo.png)"></figure></span><span class="responsText">'+a.answer+"</span></div>")});var e=$(".Messages_list").find(".msg").last().offset().top;$(".Messages").animate({scrollTop:e},"slow")}function get_msgs(s){$.ajax({type:"post",url:"/get/guest/msgs",async:!1,data:{ip:s},success:function(e){""==e||null==e||(count=1,$.each(e,function(e,a){a.from==s?$(".Messages_list").append('<div class="msg user"><span class="avtr"><figure style="background-image: url(https://mrseankumar25.github.io/Sandeep-Kumar-Frontend-Developer-UI-Specialist/images/avatar.png)"></figure></span><span class="responsText">'+a.message+"</span></div>"):$(".Messages_list").append('<div class="msg"><span class="avtr"><figure style="background-image: url(https://demo.umbrellamd-video.com/assets/images/logo.png)"></figure></span><span class="responsText">'+a.message+"</span></div>")}))}})}jQuery(document).ready(function(s){s.getJSON("https://api.ipify.org/?format=json",function(s){ip=s.ip.split(".").join(""),get_questions(),get_msgs(ip)}),jQuery(document).on("click",".iconInner",function(e){jQuery(this).parents(".botIcon").addClass("showBotSubject"),s("[name='msg']").focus();if(s('#pop').hasClass('fa fa-circle')){s('#pop').removeClass('fa fa-circle');}}),jQuery(document).on("click",".closeBtn, .chat_close_icon",function(s){jQuery(this).parents(".botIcon").removeClass("showBotSubject"),jQuery(this).parents(".botIcon").removeClass("showMessenger")}),jQuery(document).on("submit","#botSubject",function(s){s.preventDefault(),jQuery(this).parents(".botIcon").removeClass("showBotSubject"),jQuery(this).parents(".botIcon").addClass("showMessenger")}),s(document).on("submit","#messenger",function(e){e.preventDefault(),s("[name=msg]").val().toLowerCase();var a=s("[name=msg]").val();if(0==count){s("[name='msg']").val(""),s(".Messages_list").append('<div class="msg user"><span class="avtr"><figure style="background-image: url(https://mrseankumar25.github.io/Sandeep-Kumar-Frontend-Developer-UI-Specialist/images/avatar.png)"></figure></span><span class="responsText">'+a+"</span></div>"),s(".Messages_list").append('<div class="msg"><span class="avtr"><figure style="background-image: url(https://demo.umbrellamd-video.com/assets/images/logo.png)"></figure></span><span class="responsText">Click on the questions bellow</span></div>'),s.each(JSON.parse(data),function(e,a){s(".Messages_list").append('<div onclick="reply('+a.id+')" class="msg" style="cursor:pointer;"><span class="avtr"><figure style="background-image: url(https://demo.umbrellamd-video.com/assets/images/logo.png)"></figure></span><span class="responsText">'+a.question+"</span></div>")}),s(".Messages_list").append('<div onclick="reply(0)" class="msg" style="cursor:pointer;"><span class="avtr"><figure style="background-image: url(https://demo.umbrellamd-video.com/assets/images/logo.png)"></figure></span><span class="responsText">click to connect with support</span></div>');var t=s(".Messages_list").find(".msg").last().offset().top;s(".Messages").animate({scrollTop:t},"slow")}else if(""!=a&&""!=ip){function n(e){s(".Messages_list").append('<div class="msg"><span class="avtr"><figure style="background-image: url(https://demo.umbrellamd-video.com/assets/images/logo.png)"></figure></span><span class="responsText">'+e+"</span></div>"),s("[name='msg']").val("")}send_guest_msg(ip,a),s("[name=msg]").val(""),nowhoue=(nowtime=new Date).getHours(),s(".Messages_list").append('<div class="msg user"><span class="avtr"><figure style="background-image: url(https://mrseankumar25.github.io/Sandeep-Kumar-Frontend-Developer-UI-Specialist/images/avatar.png)"></figure></span><span class="responsText">'+a+"</span></div>");var o,t=s(".Messages_list").find(".msg").last().offset().top;s(".Messages").animate({scrollTop:t},"slow")}})});
